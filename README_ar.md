[English](README.md)

# نظام إدارة النقل

تطبيق سطح مكتب تم تطويره باستخدام **PyQt5** و**SQLAlchemy** لإدارة لوجستيات نقل الموظفين، بما في ذلك تتبع الحضور، إدارة خطوط السير، وتحليل التكاليف. يتكامل التطبيق مع قاعدة بيانات SQLite لتخزين واسترجاع البيانات، ويدعم استيراد البيانات من ملفات إكسل لإدارة البيانات بكفاءة.

## جدول المحتويات
- [نظرة عامة على المشروع](#نظرة-عامة-على-المشروع)
- [الميزات](#الميزات)
- [التقنيات المستخدمة](#التقنيات-المستخدمة)
- [تعليمات التثبيت](#تعليمات-التثبيت)
- [هيكل قاعدة البيانات](#هيكل-قاعدة-البيانات)
- [كيفية الاستخدام](#كيفية-الاستخدام)
- [بيانات العينة](#بيانات-العينة)
- [المساهمة](#المساهمة)
- [الترخيص](#الترخيص)

## نظرة عامة على المشروع
**نظام إدارة النقل** مصمم لتبسيط لوجستيات نقل الموظفين في شركة. يتيح للمستخدمين:
- إدارة بيانات الموظفين وخطوط السير والتكاليف من خلال واجهة مستخدم رسومية سهلة.
- إصدار تقارير النقل اليومية بناءً على حضور الموظفين.
- استيراد البيانات من ملفات إكسل إلى قاعدة بيانات SQLite.
- تحليل تكاليف النقل حسب الأقسام وتصدير التقارير إلى إكسل.

يعكس هذا المشروع مهارات في:
- **تطوير تطبيقات سطح المكتب**: باستخدام PyQt5 لواجهة مستخدم تفاعلية.
- **تكامل قواعد البيانات**: باستخدام SQLAlchemy لعمليات قاعدة البيانات باستخدام ORM.
- **معالجة البيانات**: التعامل مع بيانات إكسل باستخدام pandas وopenpyxl.
- **معالجة الأخطاء والتسجيل**: إدارة قوية للأخطاء وتسجيل الأحداث لتتبع الأخطاء.

## الميزات
- **إدارة البيانات**: إضافة، تعديل، وعرض بيانات الموظفين، خطوط السير، والتكاليف في واجهة جدولية.
- **تتبع الحضور**: اختيار الموظفين لإصدار تقارير النقل اليومية، بما في ذلك تفاصيل خط السير، عدد الركاب، والتكاليف.
- **استيراد البيانات**: استيراد بيانات الموظفين، خطوط السير، والتكاليف من ملفات إكسل إلى قاعدة البيانات.
- **تحليل التكاليف**: تحليل تكاليف النقل حسب الأقسام لنطاق زمني محدد.
- **تصدير إلى إكسل**: تصدير التقارير المُنشأة إلى ملفات إكسل لتحليل إضافي.
- **وظيفة البحث**: تصفية الموظفين حسب الاسم لاختيار سريع في نافذة الحضور.
- **واجهة مستخدم تفاعلية**: تم بناؤها باستخدام PyQt5 لتجربة مستخدم حديثة وبديهية.

## التقنيات المستخدمة
- **Python 3.x**: لغة البرمجة الأساسية.
- **PyQt5**: لبناء واجهة المستخدم الرسومية.
- **SQLAlchemy**: لإدارة قاعدة البيانات باستخدام ORM.
- **pandas**: لمعالجة بيانات إكسل وإنشاء التقارير.
- **openpyxl**: لقراءة وكتابة ملفات إكسل.
- **SQLite**: قاعدة بيانات خفيفة لتخزين بيانات الموظفين، خطوط السير، والتكاليف.
- **التسجيل (Logging)**: لتتبع أحداث التطبيق والأخطاء.

## تعليمات التثبيت
### المتطلبات الأساسية
- Python 3.8 أو أعلى
- pip (مدير حزم Python)

### خطوات التثبيت
1. **استنساخ المستودع**:
   ```bash
   git clone https://github.com/your-username/transport-management-system.git
   cd transport-management-system
   ```

2. **تثبيت التبعيات**:
   قم بتثبيت الحزم المطلوبة المدرجة في `requirements.txt`:
   ```bash
   pip install -r requirements.txt
   ```

3. **إعداد قاعدة البيانات**:
   قم بتشغيل سكربت `database_setup.py` لإنشاء قاعدة بيانات SQLite والجداول:
   ```bash
   python database_setup.py
   ```

4. **استيراد بيانات العينة**:
   استخدم ملف `sample_data.xlsx` المرفق لتعبئة قاعدة البيانات ببيانات وهمية:
   ```bash
   python data_import.py
   ```
   بديلًا، استبدل `sample_data.xlsx` بملف إكسل خاص بك يتطابق مع الهيكلية المطلوبة (انظر [بيانات العينة](#بيانات-العينة)).

5. **تشغيل التطبيق**:
   قم بتشغيل التطبيق الرئيسي:
   ```bash
   python main_app2.py
   ```

## هيكل قاعدة البيانات
يستخدم التطبيق قاعدة بيانات SQLite (`transport_management.db`) تحتوي على الجداول التالية:

- **employees** (الموظفون):
  - `employee_id` (رقم صحيح، المفتاح الأساسي)
  - `employee_name` (نص)
  - `department` (نص)
  - `station` (نص)
  - `route_code` (نص، مفتاح خارجي لجدول `routes`)
  - `notes` (نص)

- **routes** (خطوط السير):
  - `route_code` (نص، المفتاح الأساسي)
  - `route_name` (نص)
  - `vehicle_type` (نص)
  - `contractor_name` (نص)
  - `supervisor_name` (نص)
  - `route_stations` (نص، مفصول بفواصل)

- **route_costs** (تكاليف خطوط السير):
  - `route_code` (نص، المفتاح الأساسي، مفتاح خارجي لجدول `routes`)
  - `vehicle_capacity` (رقم صحيح)
  - `cost_5_days` (رقم عشري)
  - `cost_4_days` (رقم عشري)
  - `cost_3_days` (رقم عشري)

## كيفية الاستخدام
1. **تشغيل التطبيق**:
   قم بتشغيل `main_app2.py` لفتح النافذة الرئيسية.

2. **عرض وإدارة البيانات**:
   - استخدم القائمة المنسدلة لاختيار جدول (`employees`، `routes`، أو `route_costs`).
   - اعرض البيانات في عرض الجدول.
   - انقر على **إضافة بيانات** لإدخال سجلات جديدة أو **تعديل البيانات** لتعديل السجلات الحالية.

3. **إصدار تقارير الحضور**:
   - انقر على **إصدار تقرير الحضور** لفتح نافذة الحضور.
   - ابحث عن الموظفين بالاسم، أضفهم إلى القائمة المختارة، ثم أصدر التقرير.
   - اعرض ملخص التقرير واختر حفظ التقرير كملف إكسل إذا لزم الأمر.

4. **استيراد البيانات**:
   - قم بتشغيل `data_import.py` مع ملف إكسل لتعبئة قاعدة البيانات.
   - تأكد من أن ملف الإكسل يحتوي على ثلاث أوراق (`Sheet1`، `Sheet2`، `Sheet3`) بأعمدة تتطابق مع هيكل قاعدة البيانات.

## بيانات العينة
يحتوي المستودع على ملف `sample_data.xlsx` مع بيانات وهمية لتوضيح وظائف التطبيق. يحتوي الملف على:
- **Sheet1**: بيانات الموظفين (الأعمدة: `employee_name`، `department`، `station`، `route_name`، `route_code`، `notes`)
- **Sheet2**: بيانات خطوط السير (الأعمدة: `route_code`، `route_name`، `vehicle_type`، `contractor_name`، `supervisor_name`، `route_stations`)
- **Sheet3**: بيانات تكاليف خطوط السير (الأعمدة: `route_code`، `vehicle_capacity`، `cost_5_days`، `cost_4_days`، `cost_3_days`)

لاستخدام بياناتك الخاصة، قم بإنشاء ملف إكسل بنفس الهيكلية وقم بتحديث `data_import.py` للإشارة إلى ملفك.

## المساهمة
نرحب بالمساهمات! يرجى اتباع الخطوات التالية:
1. استنسخ المستودع.
2. أنشئ فرعًا جديدًا (`git checkout -b feature/your-feature`).
3. قم بإجراء التغييرات وتسجيلها (`git commit -m "إضافة ميزتك"`).
4. ادفع التغييرات إلى الفرع (`git push origin feature/your-feature`).
5. أنشئ طلب دمج (Pull Request).

## الترخيص
هذا المشروع مرخص بموجب ترخيص MIT. راجع ملف [LICENSE](LICENSE) للحصول على التفاصيل.